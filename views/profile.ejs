<%- include('partials/header') %>

<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="d-flex align-items-center mb-4">
            <div class="rounded-circle bg-primary bg-opacity-10 p-3 me-3">
                <i class="fas fa-user-cog fa-2x text-primary"></i>
            </div>
            <div>
                <h2 class="fw-bold mb-0">Profile Settings</h2>
                <p class="text-muted mb-0">Manage your account and API credentials</p>
            </div>
        </div>

        <% if (error) { %>
            <div class="alert alert-danger d-flex align-items-center mb-4" role="alert">
                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                <div><%= error %></div>
            </div>
        <% } %>
        <% if (success) { %>
            <div class="alert alert-success d-flex align-items-center mb-4" role="alert">
                <i class="bi bi-check-circle-fill me-2"></i>
                <div><%= success %></div>
            </div>
        <% } %>
        
        <div class="card mb-5">
            <div class="card-header">
                <h4 class="mb-0"><i class="fas fa-key me-2 text-info"></i> API Configuration</h4>
            </div>
            <div class="card-body">
                <form action="/profile" method="POST">
                    <div class="mb-4">
                        <label for="username" class="form-label text-uppercase small fw-bold text-muted">Username</label>
                        <input type="text" class="form-control" id="username" value="<%= user.username %>" disabled>
                    </div>
                    <div class="mb-4">
                        <label for="ptero_url" class="form-label text-uppercase small fw-bold text-muted">Pterodactyl Panel URL</label>
                        <div class="input-group">
                            <span class="input-group-text bg-transparent border-end-0 text-muted"><i class="fas fa-link"></i></span>
                            <input type="url" class="form-control border-start-0 ps-0" id="ptero_url" name="ptero_url" value="<%= user.ptero_url || '' %>" placeholder="https://panel.example.com">
                        </div>
                        <div class="form-text text-muted">The URL to your Pterodactyl panel.</div>
                    </div>
                    <div class="mb-4">
                        <label for="ptero_api_key" class="form-label text-uppercase small fw-bold text-muted">Pterodactyl API Key</label>
                        <div class="input-group">
                            <span class="input-group-text bg-transparent border-end-0 text-muted"><i class="fas fa-key"></i></span>
                            <input type="password" class="form-control border-start-0 ps-0" id="ptero_api_key" name="ptero_api_key" value="<%= user.ptero_api_key || '' %>" placeholder="ptlc_...">
                        </div>
                        <div class="form-text text-muted">Your Client API Key from the Account API tab.</div>
                    </div>
                    <div class="d-flex justify-content-end">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-2"></i> Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h4 class="mb-0"><i class="fas fa-lock me-2 text-warning"></i> Security</h4>
            </div>
            <div class="card-body">
                <form action="/profile/password" method="POST">
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label for="current_password" class="form-label text-uppercase small fw-bold text-muted">Current Password</label>
                            <input type="password" class="form-control" id="current_password" name="current_password" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="new_password" class="form-label text-uppercase small fw-bold text-muted">New Password</label>
                            <input type="password" class="form-control" id="new_password" name="new_password" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="confirm_password" class="form-label text-uppercase small fw-bold text-muted">Confirm New Password</label>
                            <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mt-2">
                        <button type="submit" class="btn btn-warning">
                            <i class="fas fa-shield-alt me-2"></i> Change Password
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<%- include('partials/footer') %>
